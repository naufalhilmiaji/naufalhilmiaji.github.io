---
import BaseLayout from "../../layouts/BaseLayout.astro";
import Container from "../../components/Container.astro";
import Section from "../../components/Section.astro";
import ProjectCard from "../../components/ProjectCard.astro";
import ProjectModal from "../../components/ProjectModal.astro";
import { PROJECTS } from "../../data/projects";

const languages = Array.from(
  new Set(
    PROJECTS
      .map(p => p.tech?.[0])
      .filter((t): t is string => Boolean(t))
  )
);
---

<BaseLayout title="Infrastructure & Projects">
  <Container>
    <Section class="py-8 md:py-16 border-b border-border-subtle">
      <h1 class="text-4xl md:text-5xl font-bold tracking-tight text-text-main mb-6">
        <span class="text-accent font-mono text-xl mr-4">//</span>Projects
      </h1>
      <p class="text-lg text-text-muted max-w-[65ch] leading-relaxed">
        All systems, infrastructure, and automation tools developed and maintained by me.
      </p>
    </Section>

    <div class="mt-12 md:mt-16 space-y-20">
      {languages.map((lang) => (
        <section>
          <div class="flex items-center gap-4 mb-8">
            <h2 class="font-bold text-text-main tracking-widest uppercase font-mono text-sm text-accent">
              {lang}_systems
            </h2>
            <div class="h-px flex-grow bg-gradient-to-r from-border-subtle to-transparent"></div>
          </div>
          
          <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
            {PROJECTS.map((project) => (
              project.tech.includes(lang) && <ProjectCard project={project} />
            ))}
          </div>
        </section>
      ))}
    </div>
  </Container>

  <ProjectModal />
</BaseLayout>
